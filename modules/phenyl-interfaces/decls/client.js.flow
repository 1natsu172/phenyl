// @flow
import type {
  WhereQuery,
  IdQuery,
  IdsQuery,
  CustomQuery,
} from './query.js.flow'
import type { KvsClient } from './kvs-client.js.flow'
import type {
  Session,
  PreSession,
} from './session.js.flow'
import type {
  CustomQueryResult,
  SingleQueryResult,
  QueryResult,
} from './query-result.js.flow'
import type {
  CommandResult,
  CustomCommandResult,
  GetCommandResult,
  FetchCommandResult,
  LoginCommandResult,
  LogoutCommandResult,
} from './command-result.js.flow'
import type {
  InsertCommand,
  UpdateCommand,
  DeleteCommand,
  CustomCommand,
  LoginCommand,
  LogoutCommand,
} from './command.js.flow'
import type { ErrorResult } from './error-result.js.flow'

export interface EntityClient {
  find(query: WhereQuery): Promise<QueryResult | ErrorResult>,
  findOne(query: WhereQuery): Promise<SingleQueryResult | ErrorResult>,
  get(query: IdQuery): Promise<SingleQueryResult | ErrorResult>,
  getByIds(query: IdsQuery): Promise<QueryResult | ErrorResult>,

  insert(command: InsertCommand): Promise<CommandResult | ErrorResult>,
  insertAndGet(command: InsertCommand): Promise<GetCommandResult | ErrorResult>,
  insertAndFetch(command: InsertCommand): Promise<FetchCommandResult | ErrorResult>,

  update(command: UpdateCommand): Promise<CommandResult | ErrorResult>,
  updateAndGet(command: UpdateCommand): Promise<GetCommandResult | ErrorResult>,
  updateAndFetch(command: UpdateCommand): Promise<FetchCommandResult | ErrorResult>,

  delete(command: DeleteCommand): Promise<CommandResult | ErrorResult>,
}

export interface CustomClient {
  runCustomQuery(query: CustomQuery): Promise<CustomQueryResult | ErrorResult>,
  runCustomCommand(command: CustomCommand): Promise<CustomCommandResult | ErrorResult>,
}

export interface AuthClient {
  login(command: LoginCommand): Promise<LoginCommandResult | ErrorResult>,
  logout(command: LogoutCommand): Promise<LogoutCommandResult | ErrorResult>,
}

export type SessionClient = KvsClient<Session, PreSession>

export interface ClientPool {
  entityClient: EntityClient,
  sessionClient: SessionClient,
}
